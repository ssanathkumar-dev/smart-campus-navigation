<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Campus Dashboard</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        /* --- MAIN LAYOUT --- */
        body {
            margin: 0; padding: 0;
            font-family: 'Poppins', sans-serif;
            min-height: 100vh;
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(rgba(0, 0, 0, 0.6), rgba(0, 0, 0, 0.6)),
                        url('assets/college_bg.png') no-repeat center center;
            background-size: cover;
            background-attachment: fixed;
        }

        .cards-container {
            display: flex;
            flex-wrap: wrap;
            gap: 30px;
            justify-content: center;
            width: 100%;
            max-width: 1000px;
            padding: 20px;
            z-index: 10;
        }

        /* --- GLASS CARD STYLE --- */
        .dashboard-card {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(25px); -webkit-backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.7);
            padding: 40px 30px;
            border-radius: 24px;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.35);
            flex: 1;
            min-width: 300px;
            max-width: 420px;
            text-align: center;
            animation: slideUpFade 0.8s cubic-bezier(0.2, 0.8, 0.2, 1) forwards;
            opacity: 0; transform: translateY(40px);
        }

        .dashboard-card:nth-child(2) { animation-delay: 0.2s; }

        @keyframes slideUpFade { to { opacity: 1; transform: translateY(0); } }

        /* --- ICONS & TEXT --- */
        .map-icon { font-size: 3rem; margin-bottom: 15px; display: inline-block; }
        h2 { color: #1e293b; margin: 0 0 5px 0; font-weight: 700; font-size: 1.5rem; }
        p.subtitle { color: #64748b; font-size: 0.9rem; margin: 0 0 25px 0; font-weight: 500; }

        /* --- INPUTS --- */
        .input-group { margin-bottom: 20px; text-align: left; width: 100%; }
        label { display: block; margin-bottom: 8px; color: #334155; font-weight: 600; font-size: 0.85rem; padding-left: 4px; }

        input[type="text"], select {
            width: 100%;
            padding: 14px 18px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 0.95rem;
            background: #f8fafc;
            font-family: 'Poppins', sans-serif;
            transition: all 0.3s ease;
            box-sizing: border-box;
            appearance: none;
        }

        .select-wrapper { position: relative; }
        .select-wrapper::after {
            content: '‚ñº'; font-size: 0.8rem; color: #64748b;
            position: absolute; right: 15px; top: 50%; transform: translateY(-50%); pointer-events: none;
        }

        input[type="text"]:focus, select:focus {
            border-color: #3b82f6; background: white; outline: none;
            box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.15);
        }

        /* --- BUTTONS --- */
        .btn-go {
            width: 100%; padding: 16px;
            background: linear-gradient(135deg, #2563eb, #3b82f6);
            color: white; border: none; border-radius: 12px;
            font-size: 1rem; font-weight: 700; cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 10px 20px -5px rgba(37, 99, 235, 0.4);
            margin-top: 10px;
        }

        .btn-go.secondary {
            background: linear-gradient(135deg, #8b5cf6, #a78bfa); /* Purple for Indoor */
            box-shadow: 0 10px 20px -5px rgba(139, 92, 246, 0.4);
        }

        .btn-go:hover { transform: translateY(-3px); box-shadow: 0 15px 30px -5px rgba(37, 99, 235, 0.5); }
        .btn-back {
            position: absolute; top: 20px; left: 20px; color: white;
            text-decoration: none; font-weight: 600;
            text-shadow: 0 2px 4px rgba(0,0,0,0.5);
        }
    </style>
</head>
<body>

    <a href="index.html" class="btn-back">‚Üê Back Home</a>

    <div class="cards-container">
        
        <div class="dashboard-card">
            <div class="map-icon">üó∫Ô∏è</div> 
            <h2>Outdoor Route</h2>
            <p class="subtitle">Navigate across campus grounds.</p>
            
            <div class="input-group">
                <label for="startInput">Your Location</label>
                <input type="text" id="startInput" placeholder="e.g. Main Gate" autocomplete="off">
            </div>

            <div class="input-group">
                <label for="endInput">Destination</label>
                <input type="text" id="endInput" placeholder="e.g. Canteen" autocomplete="off">
            </div>

            <button onclick="goToOutdoor()" class="btn-go">Start Navigation</button>
        </div>

        <div class="dashboard-card">
            <div class="map-icon">üè¢</div> 
            <h2>Indoor Route</h2>
            <p class="subtitle">Find rooms inside buildings.</p>
            
            <div class="input-group">
                <label for="buildingSelect">Select Building</label>
                <div class="select-wrapper">
                    <select id="buildingSelect">
                        <option value="" disabled selected>-- Choose Building --</option>
                    </select>
                </div>
            </div>

            <div class="input-group">
                <label for="indoorStartInput">Your Location (Start)</label>
                <input type="text" id="indoorStartInput" placeholder="e.g. Room 101" autocomplete="off">
            </div>

            <div class="input-group">
                <label for="indoorEndInput">Room Number (Destination)</label>
                <input type="text" id="indoorEndInput" placeholder="e.g. Room 205" autocomplete="off">
            </div>

            <button onclick="navigateIndoor()" class="btn-go secondary">Find Indoor Route</button>
            
            <div style="display: flex; gap: 10px; margin-top: 15px;">
                <button type="button" 
                        onclick="window.location.href='map.html?force_floor=1st Floor'" 
                        style="flex:1; padding: 10px; background-color: #f59e0b; color: white; border: none; border-radius: 8px; font-weight: bold; cursor: pointer;">
                    üõ†Ô∏è 1st
                </button>
                <button type="button" 
                        onclick="window.location.href='map.html?force_floor=2nd Floor'" 
                        style="flex:1; padding: 10px; background-color: #f59e0b; color: white; border: none; border-radius: 8px; font-weight: bold; cursor: pointer;">
                    üõ†Ô∏è 2nd
                </button>
                <button type="button" 
                        onclick="window.location.href='map.html?force_floor=3rd Floor'" 
                        style="flex:1; padding: 10px; background-color: #f59e0b; color: white; border: none; border-radius: 8px; font-weight: bold; cursor: pointer;">
                    üõ†Ô∏è 3rd
                </button>
            </div>

    </div>

    <script>
        // --- DATA: Define Buildings ---
        const buildings = ["Main Building", "MBA Block", "Library"];
        const buildingSelect = document.getElementById('buildingSelect');

        // Populate Building Dropdown
        window.onload = function() {
            buildings.forEach(b => {
                let option = document.createElement('option');
                option.value = b;
                option.text = b;
                buildingSelect.appendChild(option);
            });
        };

        // 1. Outdoor Navigation Logic
        function goToOutdoor() {
            const start = document.getElementById('startInput').value;
            const end = document.getElementById('endInput').value;
            if(!start || !end) {
                alert("Please enter both locations."); 
                return;
            }
            window.location.href = `map.html?start=${encodeURIComponent(start)}&end=${encodeURIComponent(end)}`;
        }

        // --- Helper: Determine Floor from Room Number ---
        function getFloorFromRoom(roomStr) {
            const match = roomStr.match(/\d+/);
            if (match) {
                const roomNum = parseInt(match[0]);
                if (roomNum >= 100 && roomNum <= 199) return "Ground Floor";
                if (roomNum >= 200 && roomNum <= 299) return "1st Floor";
                if (roomNum >= 300 && roomNum <= 399) return "2nd Floor";
                // Added 4xx logic
                if (roomNum >= 400 && roomNum <= 499) return "3rd Floor"; 
            }
            return null;
        }

        // 2. Indoor Navigation Logic
        function navigateIndoor() {
            const building = buildingSelect.value;
            const start = document.getElementById('indoorStartInput').value;
            const end = document.getElementById('indoorEndInput').value;
            
            if(!building) {
                alert("Please select a building.");
                return;
            }
            if(!start || !end) {
                alert("Please enter both Start and Destination.");
                return;
            }

            const startFloor = getFloorFromRoom(start);
            const endFloor = getFloorFromRoom(end);

            // --- CHECK: Are they on different floors? ---
            if (startFloor && endFloor && startFloor !== endFloor) {
                alert(`Please proceed to ${endFloor} to continue navigation.`);
                return; // <--- STOP EXECUTION HERE. Do not redirect.
            }

            // Only executes if floors are same or unknown
            const url = `map.html?building=${encodeURIComponent(building)}&indoorStart=${encodeURIComponent(start)}&indoorEnd=${encodeURIComponent(end)}`;
            window.location.href = url;
        }
    </script>

</body>
</html>